---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.1'
      jupytext_version: 1.1.6
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Operating on Data in Pandas

```python
import pandas as pd
import numpy as np
```

```python
rng = np.random.RandomState(42)
ser = pd.Series(rng.randint(0, 10, 4))
ser
```

```python
df = pd.DataFrame(rng.randint(0, 10, (3, 4)),
                  columns=['A', 'B', 'C', 'D'])
df
```

```python
np.exp(ser)
```

```python
np.sin(df * np.pi / 4)
```

```python
area = pd.Series({'Alaska': 1723337, 'Texas': 695662,
                  'California': 423967}, name='area')
population = pd.Series({'California': 38332521, 'Texas': 26448193,
                        'New York': 19651127}, name='population')
```

```python
population / area
```

```python
area.index | population.index
```

```python
A = pd.Series([2, 4, 6], index=[0, 1, 2])
B = pd.Series([1, 3, 5], index=[1, 2, 3])
A + B
```

```python
A.add(B, fill_value=0)
```

```python
A = pd.DataFrame(rng.randint(0, 20, (2, 2)),
                 columns=list('AB'))
A
```

```python
B = pd.DataFrame(rng.randint(0, 10, (3, 3)),
                 columns=list('BAC'))
B
```

```python
A + B
```

```python
fill = A.stack().mean()
A.add(B, fill_value=fill)
```

```python
A = rng.randint(10, size=(3, 4))
A
```

```python
A - A[0]
```

```python
df = pd.DataFrame(A, columns=list('QRST'))
df - df.iloc[0]
```

```python
df.subtract(df['R'], axis=0)
```

```python
halfrow = df.iloc[0, ::2]
halfrow
```

```python
df - halfrow
```
