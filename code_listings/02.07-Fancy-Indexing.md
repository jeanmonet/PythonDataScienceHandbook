---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.1'
      jupytext_version: 1.1.6
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Fancy Indexing

```python
import numpy as np
rand = np.random.RandomState(42)

x = rand.randint(100, size=10)
print(x)
```

```python
[x[3], x[7], x[2]]
```

```python
ind = [3, 7, 4]
x[ind]
```

```python
ind = np.array([[3, 7],
                [4, 5]])
x[ind]
```

```python
X = np.arange(12).reshape((3, 4))
X
```

```python
row = np.array([0, 1, 2])
col = np.array([2, 1, 3])
X[row, col]
```

```python
X[row[:, np.newaxis], col]
```

```python
row[:, np.newaxis] * col
```

```python
print(X)
```

```python
X[2, [2, 0, 1]]
```

```python
X[1:, [2, 0, 1]]
```

```python
mask = np.array([1, 0, 1, 0], dtype=bool)
X[row[:, np.newaxis], mask]
```

```python
mean = [0, 0]
cov = [[1, 2],
       [2, 5]]
X = rand.multivariate_normal(mean, cov, 100)
X.shape
```

```python
%matplotlib inline
import matplotlib.pyplot as plt
import seaborn; seaborn.set()  # for plot styling

plt.scatter(X[:, 0], X[:, 1]);
```

```python
indices = np.random.choice(X.shape[0], 20, replace=False)
indices
```

```python
selection = X[indices]  # fancy indexing here
selection.shape
```

```python
plt.scatter(X[:, 0], X[:, 1], alpha=0.3)
plt.scatter(selection[:, 0], selection[:, 1],
            facecolor='none', s=200);
```

```python
x = np.arange(10)
i = np.array([2, 1, 8, 4])
x[i] = 99
print(x)
```

```python
x[i] -= 10
print(x)
```

```python
x = np.zeros(10)
x[[0, 0]] = [4, 6]
print(x)
```

```python
i = [2, 3, 3, 4, 4, 4]
x[i] += 1
x
```

```python
x = np.zeros(10)
np.add.at(x, i, 1)
print(x)
```

```python
np.random.seed(42)
x = np.random.randn(100)

# compute a histogram by-hand
bins = np.linspace(-5, 5, 20)
counts = np.zeros_like(bins)

# find the appropriate bin for each x
i = np.searchsorted(bins, x)

# add 1 to each of these bins
np.add.at(counts, i, 1)
```

```python
# plot the results
plt.plot(bins, counts, linestyle='steps');
```

```python
print("NumPy routine:")
%timeit counts, edges = np.histogram(x, bins)

print("Custom routine:")
%timeit np.add.at(counts, np.searchsorted(bins, x), 1)
```

```python
x = np.random.randn(1000000)
print("NumPy routine:")
%timeit counts, edges = np.histogram(x, bins)

print("Custom routine:")
%timeit np.add.at(counts, np.searchsorted(bins, x), 1)
```
