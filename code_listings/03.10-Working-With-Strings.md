---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.1'
      jupytext_version: 1.1.6
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Vectorized String Operations

```python
import numpy as np
x = np.array([2, 3, 5, 7, 11, 13])
x * 2
```

```python
data = ['peter', 'Paul', 'MARY', 'gUIDO']
[s.capitalize() for s in data]
```

```python
data = ['peter', 'Paul', None, 'MARY', 'gUIDO']
[s.capitalize() for s in data]
```

```python
import pandas as pd
names = pd.Series(data)
names
```

```python
names.str.capitalize()
```

```python
monte = pd.Series(['Graham Chapman', 'John Cleese', 'Terry Gilliam',
                   'Eric Idle', 'Terry Jones', 'Michael Palin'])
```

```python
monte.str.lower()
```

```python
monte.str.len()
```

```python
monte.str.startswith('T')
```

```python
monte.str.split()
```

```python
monte.str.extract('([A-Za-z]+)')
```

```python
monte.str.findall(r'^[^AEIOU].*[^aeiou]$')
```

```python
monte.str[0:3]
```

```python
monte.str.split().str.get(-1)
```

```python
full_monte = pd.DataFrame({'name': monte,
                           'info': ['B|C|D', 'B|D', 'A|C', 'B|D', 'B|C', 'B|C|D']})
full_monte
```

```python
full_monte['info'].str.get_dummies('|')
```

```python
# !curl -O http://openrecipes.s3.amazonaws.com/recipeitems-latest.json.gz
# !gunzip recipeitems-latest.json.gz
```

```python
try:
    recipes = pd.read_json('recipeitems-latest.json')
except ValueError as e:
    print("ValueError:", e)
```

```python
with open('recipeitems-latest.json') as f:
    line = f.readline()
pd.read_json(line).shape
```

```python
# read the entire file into a python array
with open('recipeitems-latest.json', 'r') as f:
    # Extract each line
    data = (line.strip() for line in f)
    # Reformat so each line is the element of a list
    data_json = "[{0}]".format(','.join(data))
# read the result as a JSON
recipes = pd.read_json(data_json)
```

```python
recipes.shape
```

```python
recipes.iloc[0]
```

```python
recipes.ingredients.str.len().describe()
```

```python
recipes.name[np.argmax(recipes.ingredients.str.len())]
```

```python
recipes.description.str.contains('[Bb]reakfast').sum()
```

```python
recipes.ingredients.str.contains('[Cc]innamon').sum()
```

```python
recipes.ingredients.str.contains('[Cc]inamon').sum()
```

```python
spice_list = ['salt', 'pepper', 'oregano', 'sage', 'parsley',
              'rosemary', 'tarragon', 'thyme', 'paprika', 'cumin']
```

```python
import re
spice_df = pd.DataFrame(dict((spice, recipes.ingredients.str.contains(spice, re.IGNORECASE))
                             for spice in spice_list))
spice_df.head()
```

```python
selection = spice_df.query('parsley & paprika & tarragon')
len(selection)
```

```python
recipes.name[selection.index]
```
